var Je=Object.defineProperty,Pe=Object.defineProperties;var Ne=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var fe=(t,e,n)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,T=(t,e)=>{for(var n in e||(e={}))Ee.call(e,n)&&fe(t,n,e[n]);if(ce)for(var n of ce(e))Ae.call(e,n)&&fe(t,n,e[n]);return t},pe=(t,e)=>Pe(t,Ne(e));import{c as G,W as Me,v as de,S as X,i as B,s as V,e as _,a as y,b as S,n as K,d as O,f as Ce,g as me,h as J,t as N,j as M,k as p,l as C,m as F,r as ge,o as H,p as x,q as L,u as q,w as $,x as Fe,y as We,z as Le}from"./vendor.d7b0ae96.js";const ze=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};ze();function we(t){return G.exports.SHA512(t).toString()}function _e(t,e,n=3){let l=G.exports.AES.encrypt(t,e).toString();return n>0?_e(l,e,n-1):l}function he(t,e,n=3){let l=G.exports.AES.decrypt(t,e).toString(G.exports.enc.Utf8);return n>0?he(l,e,n-1):l}function ve(t,e,n=3){return _e(JSON.stringify(t),e,n)}function be(t,e,n=3){let l={};try{l=JSON.parse(he(t,e,n))}catch{console.warn("not a json obj")}return l}const De="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweDlGNTA0MmJjNzk4RjQxOEJmNkMwZGNiMEExMjU5Y2FEM0RCOTRENzgiLCJpc3MiOiJ3ZWIzLXN0b3JhZ2UiLCJpYXQiOjE2NDA0NDg4MjM0NjYsIm5hbWUiOiJpcm9uaWMtcGFzc3dvcmQtbWFuYWdlciJ9.P4GyOS9rL29eRYQvmjocO3nZKcm9VKJO5fOPYgMj_mA",ee=new Me({token:De}),ye="458024994350udf9ua0d9f7af098a";function Re(t,e){return t.lastModifiedDate=new Date,t.name=e,t}async function qe(t,e){const n=[];for await(const l of ee.list())(!e||e(l))&&(n.push(l),t&&t(l,n));return n}async function Ue(t,e=de()){console.log("[web3.storage] > putting",t,"as",e);const n=ve(t,ye),l=new Blob([n],{type:"application/json"});console.log("[web3.storage] > blob",l),console.log("[web3.storage] > uploading to IPFS..."),console.time("[web3.storage] > uploading to IPFS...");const s=await ee.put([Re(l,e)],{name:e,maxRetries:3});console.timeEnd("[web3.storage] > uploading to IPFS..."),console.log("[web3.storage] > cid",s),console.log(`https://ipfs.io/ipfs/${s}/${e}`)}async function Ye(t){const e=await ee.get(t);return e.ok?await e.files():[]}async function Ge(t,e=null){console.log("[web3.storage] > getting",t,"/",e),console.time(`[web3.storage] > quering IPFS > [${t}]`);const n=await Ye(t);console.timeEnd(`[web3.storage] > quering IPFS > [${t}]`),console.log("[web3.storage] > got",n.length,"files");const l=e===null?n[0]:n.find(i=>i.name===e),s=l?await l.text():null;let r=null;try{r=be(s,ye)}catch{console.warn("[web3.storage] > file couldnt be decrypted")}return console.log("[web3.storage] > received:",r),r}async function Ke(t,e=null){}var Qe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",list:qe,put:Ue,get:Ge,destroy:Ke});const te=localStorage,ne="Ironic.",ke="123";function Se(){return te.getItem(ne)?be(te.getItem(ne),ke,0):{}}function Ze(t){return te.setItem(ne,ve(t,ke,0))}function Te(t){return Se()[t]}function Xe(t,e){Ze(Object.assign(Se(),{[e]:t}))}const z={replaceWith:"[$dot$]",replacee:"."};function se(...t){return t.map(e=>e.replaceAll(z.replacee,z.replaceWith)).join(z.replacee)}function Be(t){return t.split(z.replacee).map(e=>e.replaceAll(z.replaceWith,z.replacee))}class D{constructor({name:e,cid:n,uuid:l=de(),details:s,username:r,icon:i,password:d}){Object.assign(this,{uuid:l,cid:n,name:e,details:s,icon:i,username:r,password:d})}static fromObj(e){return new D(e)}}function Ve(t){let e,n,l,s,r,i,d,w,b=(t[2]?"hide":"show")+"",c,a,o,f,h,m,k;return{c(){e=_("input"),n=J(),l=_("input"),s=J(),r=_("div"),i=_("input"),d=J(),w=_("span"),c=N(b),a=J(),o=_("textarea"),f=J(),h=_("button"),h.textContent="Save",y(e,"type","text"),y(e,"placeholder","Name"),y(e,"class","h2"),y(l,"type","text"),y(l,"placeholder","Username"),y(i,"type","password"),y(i,"placeholder","Password"),y(w,"class","button"),y(o,"placeholder","Details"),y(h,"class","main")},m(u,v){S(u,e,v),M(e,t[0].name),S(u,n,v),S(u,l,v),M(l,t[0].username),S(u,s,v),S(u,r,v),p(r,i),M(i,t[0].password),t[14](i),p(r,d),p(r,w),p(w,c),S(u,a,v),S(u,o,v),M(o,t[0].details),S(u,f,v),S(u,h,v),m||(k=[C(e,"input",t[11]),C(l,"input",t[12]),C(i,"input",t[13]),C(w,"click",t[15]),C(o,"input",t[16]),C(h,"click",t[6])],m=!0)},p(u,v){v&1&&e.value!==u[0].name&&M(e,u[0].name),v&1&&l.value!==u[0].username&&M(l,u[0].username),v&1&&i.value!==u[0].password&&M(i,u[0].password),v&4&&b!==(b=(u[2]?"hide":"show")+"")&&F(c,b),v&1&&M(o,u[0].details)},d(u){u&&O(e),u&&O(n),u&&O(l),u&&O(s),u&&O(r),t[14](null),u&&O(a),u&&O(o),u&&O(f),u&&O(h),m=!1,ge(k)}}}function He(t){let e,n,l,s=t[0].name+"",r,i,d,w=t[0].username+"",b,c,a,o,f=(t[1]?"less":"more")+"",h,m,k,u,v=t[0].uuid+"",P,E,j,A,oe,R,U=(t[2]?"hide":"show")+"",Q,ie,W,re,Y,Z,ae;return{c(){var g;e=_("div"),e.textContent="x",n=J(),l=_("h2"),r=N(s),i=J(),d=_("p"),b=N(w),c=J(),a=_("div"),o=_("strong"),h=N(f),m=J(),k=_("div"),u=_("span"),P=N(v),E=J(),j=_("div"),A=_("input"),oe=J(),R=_("span"),Q=N(U),ie=J(),W=_("a"),re=N("IPFS"),y(e,"class","button x-button svelte-2mn6gh"),y(a,"class","button"),y(u,"class","uuid"),A.readOnly=!0,y(A,"type","password"),y(A,"placeholder","Password"),y(R,"class","button"),y(W,"href",Y=`https://ipfs.io/ipfs/${(g=t[0])==null?void 0:g.cid}`),y(W,"target","_blank"),y(k,"id","details"),y(k,"class","svelte-2mn6gh")},m(g,I){S(g,e,I),S(g,n,I),S(g,l,I),p(l,r),S(g,i,I),S(g,d,I),p(d,b),S(g,c,I),S(g,a,I),p(a,o),p(o,h),S(g,m,I),S(g,k,I),p(k,u),p(u,P),p(k,E),p(k,j),p(j,A),M(A,t[0].password),t[9](A),p(j,oe),p(j,R),p(R,Q),p(k,ie),p(k,W),p(W,re),Z||(ae=[C(e,"click",t[5]),C(a,"click",t[7]),C(A,"input",t[8]),C(R,"click",t[10])],Z=!0)},p(g,I){var ue;I&1&&s!==(s=g[0].name+"")&&F(r,s),I&1&&w!==(w=g[0].username+"")&&F(b,w),I&2&&f!==(f=(g[1]?"less":"more")+"")&&F(h,f),I&1&&v!==(v=g[0].uuid+"")&&F(P,v),I&1&&A.value!==g[0].password&&M(A,g[0].password),I&4&&U!==(U=(g[2]?"hide":"show")+"")&&F(Q,U),I&1&&Y!==(Y=`https://ipfs.io/ipfs/${(ue=g[0])==null?void 0:ue.cid}`)&&y(W,"href",Y)},d(g){g&&O(e),g&&O(n),g&&O(l),g&&O(i),g&&O(d),g&&O(c),g&&O(a),g&&O(m),g&&O(k),t[9](null),Z=!1,ge(ae)}}}function xe(t){let e,n;function l(i,d){return i[3]?Ve:He}let s=l(t),r=s(t);return{c(){e=_("div"),r.c(),y(e,"class",n="service-wrapper "+(t[1]?"expanded":"")+" svelte-2mn6gh")},m(i,d){S(i,e,d),r.m(e,null)},p(i,[d]){s===(s=l(i))&&r?r.p(i,d):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null))),d&2&&n!==(n="service-wrapper "+(i[1]?"expanded":"")+" svelte-2mn6gh")&&y(e,"class",n)},i:K,o:K,d(i){i&&O(e),r.d()}}}function $e(t,e,n){const l=Ce();let{service:s=new D({})}=e,{expanded:r=!1}=e,{showPwd:i=!1}=e,d,{edit:w=!1}=e;function b(){console.log("deleting...",s),l("delete",s)}function c(){l("save",s),console.log("saving service...",s)}const a=()=>n(1,r=!r);function o(){s.password=this.value,n(0,s)}function f(j){me[j?"unshift":"push"](()=>{d=j,n(4,d)})}const h=()=>{n(2,i=!i),n(4,d.type=i?"text":"password",d)};function m(){s.name=this.value,n(0,s)}function k(){s.username=this.value,n(0,s)}function u(){s.password=this.value,n(0,s)}function v(j){me[j?"unshift":"push"](()=>{d=j,n(4,d)})}const P=()=>{n(2,i=!i),n(4,d.type=i?"text":"password",d)};function E(){s.details=this.value,n(0,s)}return t.$$set=j=>{"service"in j&&n(0,s=j.service),"expanded"in j&&n(1,r=j.expanded),"showPwd"in j&&n(2,i=j.showPwd),"edit"in j&&n(3,w=j.edit)},[s,r,i,w,d,b,c,a,o,f,h,m,k,u,v,P,E]}class Oe extends X{constructor(e){super();B(this,e,$e,xe,V,{service:0,expanded:1,showPwd:2,edit:3})}}function et(t){let e,n,l=t[0].name+"",s,r,i,d,w,b,c=t[0].pk+"",a,o,f,h,m,k,u=t[0].sk+"",v;return{c(){e=_("div"),n=_("h2"),s=N(l),r=J(),i=_("p"),d=_("strong"),d.textContent="public key ",w=N(":  "),b=_("span"),a=N(c),o=J(),f=_("p"),h=_("strong"),h.textContent="secret key ",m=N(":  "),k=_("span"),v=N(u)},m(P,E){S(P,e,E),p(e,n),p(n,s),p(e,r),p(e,i),p(i,d),p(i,w),p(i,b),p(b,a),p(e,o),p(e,f),p(f,h),p(f,m),p(f,k),p(k,v)},p(P,[E]){E&1&&l!==(l=P[0].name+"")&&F(s,l),E&1&&c!==(c=P[0].pk+"")&&F(a,c),E&1&&u!==(u=P[0].sk+"")&&F(v,u)},i:K,o:K,d(P){P&&O(e)}}}function tt(t,e,n){let{account:l}=e;return t.$$set=s=>{"account"in s&&n(0,l=s.account)},[l]}class nt extends X{constructor(e){super();B(this,e,tt,et,V,{account:0})}}class le{constructor(e,n,l){this.name=e,this.sk=n,this.pk=l}sign(e){return we(se(this.sk,this.name,e))}get signature(){return this.sign(this.name)}confirm(e,n){return we(se(this.sk,this.name,n))===e}static fromObj(e){return new le(e.name,e.sk,e.pk)}}function je(t,e,n){const l=t.slice();return l[7]=e[n],l}function Ie(t){let e,n;return e=new Oe({props:{service:t[7]}}),e.$on("delete",t[2]),{c(){H(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const r={};s&1&&(r.service=l[7]),e.$set(r)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){q(e.$$.fragment,l),n=!1},d(l){$(e,l)}}}function st(t){let e,n,l,s,r,i,d,w;s=new nt({props:{account:t[1]}}),i=new Oe({props:{edit:"true"}}),i.$on("save",t[3]);let b=t[0],c=[];for(let o=0;o<b.length;o+=1)c[o]=Ie(je(t,b,o));const a=o=>q(c[o],1,1,()=>{c[o]=null});return{c(){e=_("main"),n=_("h1"),n.textContent="IPM",l=J(),H(s.$$.fragment),r=J(),H(i.$$.fragment),d=J();for(let o=0;o<c.length;o+=1)c[o].c()},m(o,f){S(o,e,f),p(e,n),p(e,l),x(s,e,null),p(e,r),x(i,e,null),p(e,d);for(let h=0;h<c.length;h+=1)c[h].m(e,null);w=!0},p(o,[f]){const h={};if(f&2&&(h.account=o[1]),s.$set(h),f&5){b=o[0];let m;for(m=0;m<b.length;m+=1){const k=je(o,b,m);c[m]?(c[m].p(k,f),L(c[m],1)):(c[m]=Ie(k),c[m].c(),L(c[m],1),c[m].m(e,null))}for(Le(),m=b.length;m<c.length;m+=1)a(m);Fe()}},i(o){if(!w){L(s.$$.fragment,o),L(i.$$.fragment,o);for(let f=0;f<b.length;f+=1)L(c[f]);w=!0}},o(o){q(s.$$.fragment,o),q(i.$$.fragment,o),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)q(c[f]);w=!1},d(o){o&&O(e),$(s),$(i),We(c,o)}}}function lt(t,e,n){var c;window.web3=Object.assign(window.web3||{},{storage:Qe});let{state:l=Te("state")||{}}=e,{services:s=((c=l==null?void 0:l.services)==null?void 0:c.map(a=>D.fromObj(a)))||[]}=e;async function r(a){return await web3.storage.list(async o=>{if(s.find(h=>h.cid==o.cid))return;let f=await web3.storage.get(o.cid);n(0,s=[...s,new D(pe(T({},f),{cid:o.cid}))])},o=>{let[f,h,m]=Be(o.name);return h===a.signature&&a.confirm(m,f)})}async function i(a,o){if(!o)return new Error("no account");(s==null?void 0:s.some(m=>m.name==a.name))&&prompt(`A service named ${a.name} is already in your account!`);let f=se(a.uuid,o.signature,o.sign(a.uuid));return await web3.storage.put(a,f)}async function d(a){let o=a.detail;if(console.log("deleting service....",o),!w)throw new Error("no account");n(0,s=[...s.filter(f=>f.cid!=o.cid)]),console.log(s),await web3.storage.destroy(o.cid)}let{account:w=le.fromObj({name:"robomonk",sk:"0x0850qjasdf092r9834ofa9df",pk:"0x0948520-853092842-204849"})}=e;r(w),window.storeService=async a=>{console.log("services",s),i(new D(T({},a)),w)};function b(a){let o=a.detail;console.log("service",o),i(o,w)}return t.$$set=a=>{"state"in a&&n(4,l=a.state),"services"in a&&n(0,s=a.services),"account"in a&&n(1,w=a.account)},t.$$.update=()=>{t.$$.dirty&3&&Xe({services:s,account:w},"state")},[s,w,d,b,l]}class ot extends X{constructor(e){super();B(this,e,lt,st,V,{state:4,services:0,account:1})}}new ot({target:document.getElementById("app")});
